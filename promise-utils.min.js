/*! promise-utils - v0.0.1 - 2013-05-09
* Copyright (c) 2013 Doug Martin; Licensed MIT */
(function(){"use strict";function n(n,t,e,r){function u(n,t){return t=t||0,$.call(n,t)}function o(n,t,e,u,o,i){return function(){return B(r.map(e.slice(o,i+o),function(r,u){var i=new M;try{B(n.apply(t||e,[r,u+o,e])).then(i.callback,i.errback)}catch(c){i.errback(c)}return i}))}}function i(n,t,e,r){return H(e)&&(r=e,e=null),B(n).then(function(n){var u=J(n)?n:[n];r=r||u.length;for(var i=[],c=0,l=0,a=u.length;a>c;c+=r,l++)i.push(o(t,e,u,l,c,r));return C(i).then(function(t){return{loopResults:lt(t)||[],arr:n}},function(n){throw n=it(n),1===n.length?n[0]:n})})}function c(n){return J(n)?n:G(n)?[n]:n}function l(n,t,e,r){return i(n,t,e,r).then(function(n){return n.arr})}function a(n,t,e,r){return i(n,t,e,r).then(function(n){return n.loopResults})}function p(n,t,e,u){return i(n,t,e,u).then(function(n){var t=n.loopResults,e=n.arr;return r.filter(J(e)?e:[e],function(n,e){return t[e]})})}function f(n,t,e,u){return i(n,t,e,u).then(function(n){return r.every(n.loopResults,function(n){return!!n})})}function s(n,t,e,u){return i(n,t,e,u).then(function(n){return r.some(n.loopResults,function(n){return!!n})})}function h(){return B.apply(null,u(arguments)).then(function(n){return _.apply(r,r.map(c(n),function(n){return J(n)?n:[n]}))})}function m(n){return B(n).then(function(n){return Q.call(r,c(n))})}function d(){return B.apply(null,u(arguments)).then(function(n){return ot.apply(r,r.map(c(n),function(n){return J(n)?n:[n]}))})}function y(n){return B(n).then(function(n){return it.call(r,c(n))})}function v(){return B.apply(null,u(arguments)).then(function(n){return W.apply(r,r.map(c(n),function(n){return J(n)?n:[n]}))})}function x(){return B.apply(null,u(arguments)).then(function(n){return lt.apply(r,r.map(c(n),function(n){return J(n)?n:[n]}))})}function g(){return B.apply(null,u(arguments)).then(function(n){return rt.apply(r,r.map(c(n),function(n){return J(n)?n:[n]}))})}function b(){var n=u(arguments),t=n.pop(),e=null;return K(t)||I(t)?e=t:n.push(t),B.apply(null,n).then(function(n){return V.call(r,c(n),e)})}function k(){var n=u(arguments),t=n.pop(),e=null;return K(t)||I(t)?e=t:n.push(t),B.apply(null,n).then(function(n){return U.call(r,c(n),e)})}function E(){var n=u(arguments),t=n.pop(),e=null;return K(t)||I(t)?e=t:n.push(t),B.apply(null,n).then(function(n){return T.call(r,c(n),e)})}function q(){var n=u(arguments),t=n.pop(),e=null;return H(t)?e=t:n.push(t),B.apply(null,n).then(function(n){return ct.call(r,c(n),e)})}function w(){var n=u(arguments),t=n.pop(),e=null;return H(t)?e=t:n.push(t),B.apply(null,n).then(function(n){return Z.call(r,c(n),e)})}function R(n){return B(n).then(function(n){return ut.call(r,c(n))})}function A(n){return B(n).then(function(n){return X.call(r,c(n))})}function j(){var n=u(arguments),t=n.pop(),e=null;return H(t)?e=t:n.push(t),B.apply(null,n).then(function(n){return Y.call(r,c(n),e)})}function D(n){return B(n).then(function(n){return O.call(r,c(n))})}function S(n){return B(n).then(function(n){return nt.call(r,c(n))})}function z(){return B.apply(null,u(arguments)).then(function(n){return et.apply(r,r.map(c(n),function(n){return J(n)?n:[n]}))})}function P(){return A.apply(null,arguments)}function F(n){var t=u(arguments,1);return B(n).then(function(n){return B(tt.apply(r,[c(n)].concat(t)))})}function L(n,t){return B(n).then(function(n){var e=t.split(".");return n=c(n),ft(e).async().forEach(function(t){var e=t.match(/(\w+)\(\)$/);return ft(n).async().map(function(n){return e?n[e[1]]():n[t]},1).then(function(t){n=t})},1).then(function(){return n})})}function N(n){var t=u(arguments,1);return B(n).then(function(n){return B(at.apply(r,[c(n)].concat(t)))})}var $=Array.prototype.slice,B=t.when,C=t.serial,G=e.isDefined,H=e.isNumber,I=e.isString,J=e.isArray,K=e.isFunction,M=t.Promise,O=r.sum,Q=r.avg,T=r.sort,U=r.min,V=r.max,W=r.difference,X=r.removeDuplicates,Y=r.rotate,Z=r.permutations,_=r.zip,nt=r.transpose,tt=r.valuesAt,et=r.union,rt=r.intersect,ut=r.powerSet,ot=r.cartesian,it=r.compact,ct=r.multiply,lt=r.flatten,at=r.invoke,pt={forEach:l,map:a,filter:p,every:f,some:s,zip:h,sum:D,avg:m,sort:E,min:k,max:b,difference:v,removeDuplicates:A,unique:P,rotate:j,permutations:w,transpose:S,valuesAt:F,union:z,intersect:g,powerSet:R,cartesian:d,compact:y,multiply:q,flatten:x,pluck:L,invoke:N,then:function(n,t,e){return n.then(t,e)},both:function(n,t){return n.both(t)},promise:function(n){return n.promise()},async:function(n){return n}},ft=n.define(J,{async:function(n){return t.resolve(n)}}).define(t.isPromiseLike,pt).expose(pt);return ft}"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(module.exports=n(require("extended"),require("promise-extended"),require("is-extended"),require("array-extended"),require("object-extended"))):"function"==typeof define?define(["extended","promise-extended","is-extended","array-extended","object-extended"],function(t,e,r,u,o){return n(t,e,r,u,o)}):this.isExtended=n(this.extended,this.promiseExtended,this.isExtended,this.arrayExtended,this.objectExtended)}).call(this);